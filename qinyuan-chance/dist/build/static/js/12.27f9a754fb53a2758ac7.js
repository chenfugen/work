webpackJsonp([12],{D8em:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("3cXf"),r=i.n(a),n={name:"productList",data:function(){var t=this;return{act:"",keyBtnTxt:"开启秘钥检测",productKey:"",dialogTitle:"",loading:!1,formLoading:!0,dialogLoading:!1,firmDialogLoading:!1,dialog:!1,firmDialog:!1,burnSecret:!0,intData:[{max:null,min:null}],rule:{},form:{identifier:"",check:!1,standard:null,mark:""},formFirm:{checkFirmware:!1,checkFirmwareConfig:[{a:null,b:null,c:null}]},formKey:{checkSecret:!1},numberLimit:[{minLimitMin:0,minLimitMax:0,maxLimitMin:0,maxLimitMax:0}],editProperties:[],editDataType:{specs:{},type:""},productInfo:[],propertiesList:[],columnsTop:[{title:"基本信息",align:"left",children:[{title:"产品名称",key:"name",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.name))])}},{title:"ProductKey",key:"productKey",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.productKey))])}},{title:"通信类型",key:"netType",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.netType))])}},{title:"租售类型",key:"leaseType",align:"center",render:function(t,e){return t("div",[t("span",1==e.row.leaseType?"售卖":2==e.row.leaseType?"出租":"--")])}}]}],columnsBottom:[{title:"基本属性",align:"left",children:[{title:"属性名称",key:"name",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.name))])}},{title:"属性标识符",key:"identifier",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.identifier))])}},{title:"数据类型",key:"type",align:"center",render:function(t,e){return t("div",[t("span",e.row.dataType.type)])}},{title:"属性内容",key:"name",align:"center",width:300,render:function(t,e){return t("div",[t("div",r()(e.row.dataType.specs))])}},{title:"是否需要检测",key:"check",width:50,align:"center",render:function(t,e){return t("div",[t("div",{style:{color:"1"==e.row.check?"green":"red"}},"1"==e.row.check?"是":"否")])}},{title:"检测标准值",key:"standard",align:"center",render:function(t,e){return t("div",[t("div",{},"int"==e.row.dataType.type||"enum"==e.row.dataType.type?r()(e.row.standard):e.row.standard)])}},{title:"备注",key:"mark",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.mark))])}},{title:"操作",key:"standard",align:"center",render:function(e,i){return e("div",[e("Button",{props:{type:"text"},style:{color:"blue"},on:{click:function(){t.handleEdit(i.row)}}},"编辑")])}}]}]}},mounted:function(){this.$route.query.productKey?(this.productKey=this.$route.query.productKey,this.getListData()):this.$router.push({path:"/product/productList",name:"productList"})},watch:{intData:{handler:function(t,e){for(var i in this.intData)this.numberLimit[i].minLimitMax=Number(this.intData[i].max),this.numberLimit[i].maxLimitMin=Number(this.intData[i].min)},deep:!0}},methods:{getListData:function(){var t=this;this.loading=!0;var e=this.$api.manage_product_detail,i={productKey:this.productKey};this.$Ax.get(e,{params:i}).then(function(e){t.propertiesList=[],t.productInfo=[e.data.data.product],e.data.data.properties.length>0&&(t.propertiesList=JSON.parse(e.data.data.properties)),t.loading=!1,t.formKey.checkSecret=1==e.data.data.product.checkSecret,t.burnSecret=e.data.data.product.burnSecret}).catch(function(t){console.log(t)})},handleEdit:function(t){var e=this;this.dialogLoading=!0,this.dialog=!0,this.dialogTitle="编辑："+t.name;var i=this.$api.manage_product_detail,a={productKey:this.productKey};this.$Ax.get(i,{params:a}).then(function(i){for(var a in e.editProperties=JSON.parse(i.data.data.properties),e.numberLimit=[{minLimitMin:0,minLimitMax:0,maxLimitMin:0,maxLimitMax:0}],e.editProperties)if(e.editProperties[a].identifier==t.identifier){if(e.form.mark=e.editProperties[a].mark,e.form.identifier=t.identifier,e.editDataType=e.editProperties[a].dataType,void 0==e.editProperties[a].check||"0"==e.editProperties[a].check?e.form.check=!1:e.form.check=!0,void 0==e.editProperties[a].standard?e.form.standard=null:e.form.standard=e.editProperties[a].standard,"int"==e.editProperties[a].dataType.type||"double"==e.editProperties[a].dataType.type)if(e.intData=[{max:null,min:null}],null!=e.form.standard)for(var r in e.intData=e.form.standard,e.intData)r>e.numberLimit.length-1&&e.numberLimit.push({minLimitMin:0,minLimitMax:0,maxLimitMin:0,maxLimitMax:0}),e.numberLimit[r].minLimitMin=Number(e.editProperties[a].dataType.specs.min),e.numberLimit[r].minLimitMax=Number(e.intData[r].max),e.numberLimit[r].maxLimitMin=Number(e.intData[r].min),e.numberLimit[r].maxLimitMax=Number(e.editProperties[a].dataType.specs.max);else for(var n in e.intData)n>e.numberLimit.length-1&&e.numberLimit.push({minLimitMin:0,minLimitMax:0,maxLimitMin:0,maxLimitMax:0}),e.numberLimit[n].minLimitMin=Number(e.editProperties[a].dataType.specs.min),e.numberLimit[n].minLimitMax=Number(e.editProperties[a].dataType.specs.max),e.numberLimit[n].maxLimitMin=Number(e.editProperties[a].dataType.specs.min),e.numberLimit[n].maxLimitMax=Number(e.editProperties[a].dataType.specs.max);break}e.dialogLoading=!1}).catch(function(t){console.log(t)})},handleAddIntData:function(){this.numberLimit.push({minLimitMin:0,minLimitMax:0,maxLimitMin:0,maxLimitMax:0}),this.intData.push({max:null,min:null})},handleRemoveIntData:function(){this.intData=this.intData.slice(0,this.intData.length-1)},handleEditKey:function(){var t=this;this.loading=!0;var e=this.$api.manage_product_detail,i={productKey:this.productKey};this.$Ax.get(e,{params:i}).then(function(e){t.formKey.checkSecret="1"==e.data.data.product.checkSecret,t.loading=!1;var i="";i=t.formKey.checkSecret?"关闭":"开启",t.$Modal.confirm({title:"提示",content:"<p>确认"+i+"该产品的秘钥检测？</p>",onOk:function(){t.formKey.checkSecret=!t.formKey.checkSecret;var e=t.$api.manage_product_productCheckConfig,i={checkSecret:t.formKey.checkSecret?"1":"0",productKey:t.productInfo[0].productKey};t.$Ax.post(e,i).then(function(e){e.data.success&&(t.$Message.success(e.data.data),t.getListData())}).catch(function(t){console.log(t)})},onCancel:function(){t.$Message.success("已取消"+i+"。")}})}).catch(function(t){console.log(t)})},handleEditFirm:function(){var t=this;this.firmDialogLoading=!0;var e=this.$api.manage_product_detail,i={productKey:this.productKey};this.$Ax.get(e,{params:i}).then(function(e){var i=e.data.data.product;if(t.formFirm.checkFirmware=1==i.checkFirmware,null==i.checkFirmwareConfig||i.checkFirmwareConfig==[])t.formFirm.checkFirmwareConfig=[{a:null,b:null,c:null}];else{t.formFirm.checkFirmwareConfig=[];var a=JSON.parse(i.checkFirmwareConfig);for(var r in a){var n=a[r].split(".")[0],o=a[r].split(".")[1],c=a[r].split(".")[2];t.formFirm.checkFirmwareConfig.push({a:Number(n),b:Number(o),c:Number(c)})}}t.firmDialog=!0,t.firmDialogLoading=!1}).catch(function(t){console.log(t)})},handleEditBurn:function(){var t=this;this.loading=!0;var e=this.$api.manage_product_detail,i={productKey:this.productKey};this.$Ax.get(e,{params:i}).then(function(e){t.burnSecret=e.data.data.product.burnSecret,t.loading=!1;var i="";i=1==t.burnSecret?"关闭":"开启",t.$Modal.confirm({title:"提示",content:"<p>确认"+i+"该产品的密钥自动烧录？</p>",onOk:function(){t.burnSecret=1==t.burnSecret?0:1;var e=t.$api.manage_product_productCheckConfig,i={burnSecret:t.burnSecret,productKey:t.productInfo[0].productKey};t.$Ax.post(e,i).then(function(e){e.data.success&&(t.$Message.success(e.data.data),t.getListData())}).catch(function(t){console.log(t)})},onCancel:function(){t.$Message.success("已取消"+i+"。")}})}).catch(function(t){console.log(t)})},handleEditFirmStandard:function(t){t?this.formFirm.checkFirmwareConfig.push({a:null,b:null,c:null}):this.formFirm.checkFirmwareConfig.pop()},submit:function(){var t,e=this,i=this.$api.manage_product_configProperties;for(var a in this.editProperties)this.editProperties[a].identifier==this.form.identifier&&(this.editProperties[a].check=this.form.check,this.editProperties[a].standard="int"==this.editDataType.type?this.intData:this.form.standard,this.editProperties[a].mark=this.form.mark);t={identifierConfig:r()(this.editProperties),productKey:this.productKey},this.$refs.form.validate(function(a){if(!a)return e.changeLoading();e.$Ax.post(i,t).then(function(t){t.data.success&&(e.getListData(),e.dialog=!1)}).catch(function(t){console.log(t)}),setTimeout(function(){e.changeLoading()},1e3)})},submitFirm:function(){var t=this,e=this.$api.manage_product_productCheckConfig,i=[],a=this.formFirm.checkFirmwareConfig;for(var n in a){if(null==a[n].a||null==a[n].b||null==a[n].c)return this.$Message.error("请编辑完整固件版本号检测标准。"),this.changeLoading();i.push(a[n].a+"."+a[n].b+"."+a[n].c)}var o={checkFirmware:this.formFirm.checkFirmware?"1":"0",checkFirmwareConfig:r()(i),productKey:this.productKey};this.$refs.formFirm.validate(function(i){if(!i)return t.changeLoading();t.$Ax.post(e,o).then(function(e){e.data.success&&(t.$Message.success(e.data.data),t.getListData(),t.firmDialog=!1)}).catch(function(t){console.log(t)}),setTimeout(function(){t.changeLoading()},1e3)})},cancel:function(){this.$refs.form.resetFields()},changeLoading:function(){var t=this;this.formLoading=!1,this.$nextTick(function(){t.formLoading=!0})},dealNull:function(t){return null==t||""==t||void 0==t?"--":t}}},o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"productList"}},[i("div",{staticClass:"table clearfloat marginTop",staticStyle:{position:"relative"}},[i("div",{staticClass:"actBox clearfloat"},[i("Button",{attrs:{type:"primary"},on:{click:t.handleEditFirm}},[t._v("固件配置")]),t._v(" "),i("Button",{attrs:{type:t.formKey.checkSecret?"error":"success"},on:{click:t.handleEditKey}},[t._v(t._s(t.formKey.checkSecret?"关闭秘钥检测":"开启秘钥检测"))])],1),t._v(" "),i("Table",{attrs:{columns:t.columnsTop,data:t.productInfo,border:""}}),t._v(" "),i("Table",{staticClass:"marginTop",attrs:{columns:t.columnsBottom,data:t.propertiesList,border:""}}),t._v(" "),t.loading?i("Spin",{attrs:{fix:""}}):t._e()],1),t._v(" "),i("Modal",{staticStyle:{position:"relative"},attrs:{title:t.dialogTitle,loading:t.formLoading},on:{"on-ok":t.submit,"on-cancel":t.cancel},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("Form",{ref:"form",attrs:{model:t.form,rules:t.rule,"label-position":"right","label-width":120}},[i("FormItem",{attrs:{prop:"check",label:"需要检测:"}},[i("i-switch",{model:{value:t.form.check,callback:function(e){t.$set(t.form,"check",e)},expression:"form.check"}},[i("span",{attrs:{slot:"open"},slot:"open"},[t._v("是")]),t._v(" "),i("span",{attrs:{slot:"close"},slot:"close"},[t._v("否")])])],1),t._v(" "),"int"==t.editDataType.type?i("FormItem",{attrs:{prop:"check",label:"检测标准:"}},[t._l(t.intData,function(e,a){return i("div",{},[i("InputNumber",{attrs:{precision:0,placeholder:"大于等于",max:t.numberLimit[a].minLimitMax,min:t.numberLimit[a].minLimitMin},model:{value:t.intData[a].min,callback:function(e){t.$set(t.intData[a],"min",e)},expression:"intData[index].min"}}),t._v(" "),i("InputNumber",{attrs:{precision:0,placeholder:"小于等于",max:t.numberLimit[a].maxLimitMax,min:t.numberLimit[a].maxLimitMin},model:{value:t.intData[a].max,callback:function(e){t.$set(t.intData[a],"max",e)},expression:"intData[index].max"}})],1)}),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.handleAddIntData}},[i("Icon",{attrs:{type:"md-add"}})],1),t._v(" "),i("Button",{attrs:{type:"primary",disabled:t.intData.length<2},on:{click:t.handleRemoveIntData}},[i("Icon",{attrs:{type:"md-remove"}})],1)],2):t._e(),t._v(" "),"double"==t.editDataType.type?i("FormItem",{attrs:{prop:"check",label:"检测标准:"}},[t._l(t.intData,function(e,a){return i("div",{},[i("InputNumber",{attrs:{placeholder:"大于等于"},model:{value:t.intData[a].min,callback:function(e){t.$set(t.intData[a],"min",e)},expression:"intData[index].min"}}),t._v(" "),i("InputNumber",{attrs:{placeholder:"小于等于"},model:{value:t.intData[a].max,callback:function(e){t.$set(t.intData[a],"max",e)},expression:"intData[index].max"}})],1)}),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.handleAddIntData}},[i("Icon",{attrs:{type:"md-add"}})],1),t._v(" "),i("Button",{attrs:{type:"primary",disabled:t.intData.length<2},on:{click:t.handleRemoveIntData}},[i("Icon",{attrs:{type:"md-remove"}})],1)],2):t._e(),t._v(" "),"double"!=t.editDataType.type&&"int"!=t.editDataType.type?i("FormItem",{attrs:{prop:"check",label:"检测标准:"}},["bool"==t.editDataType.type?i("Select",{staticClass:"input",attrs:{clearable:""},model:{value:t.form.standard,callback:function(e){t.$set(t.form,"standard",e)},expression:"form.standard"}},[i("Option",{attrs:{value:1}},[t._v(t._s(t.editDataType.specs[1]))]),t._v(" "),i("Option",{attrs:{value:0}},[t._v(t._s(t.editDataType.specs[0]))])],1):t._e(),t._v(" "),"text"==t.editDataType.type?i("Input",{staticClass:"input",model:{value:t.form.standard,callback:function(e){t.$set(t.form,"standard",e)},expression:"form.standard"}}):t._e(),t._v(" "),"enum"==t.editDataType.type?i("Select",{staticClass:"input",attrs:{multiple:"",clearable:""},model:{value:t.form.standard,callback:function(e){t.$set(t.form,"standard",e)},expression:"form.standard"}},t._l(t.editDataType.specs,function(e,a){return i("Option",{key:a,attrs:{value:a}},[t._v(t._s(e))])})):t._e()],1):t._e(),t._v(" "),i("FormItem",{attrs:{prop:"mark",label:"备注:"}},[i("Input",{staticClass:"input",model:{value:t.form.mark,callback:function(e){t.$set(t.form,"mark",e)},expression:"form.mark"}})],1)],1),t._v(" "),t.dialogLoading?i("Spin",{attrs:{fix:""}}):t._e()],1),t._v(" "),i("Modal",{staticStyle:{position:"relative"},attrs:{title:t.dialogTitle,loading:t.formLoading},on:{"on-ok":t.submitFirm,"on-cancel":t.cancel},model:{value:t.firmDialog,callback:function(e){t.firmDialog=e},expression:"firmDialog"}},[i("Form",{ref:"formFirm",attrs:{model:t.formFirm,rules:t.rule,"label-position":"right","label-width":150}},[i("FormItem",{attrs:{prop:"isCheck",label:"是否需要检测:"}},[i("i-switch",{model:{value:t.formFirm.checkFirmware,callback:function(e){t.$set(t.formFirm,"checkFirmware",e)},expression:"formFirm.checkFirmware"}},[i("span",{attrs:{slot:"open"},slot:"open"},[t._v("是")]),t._v(" "),i("span",{attrs:{slot:"close"},slot:"close"},[t._v("否")])])],1),t._v(" "),i("FormItem",{attrs:{prop:"checkFirmwareConfig",label:"检测标准(固件版本号):"}},[t._l(t.formFirm.checkFirmwareConfig,function(e,a){return i("div",{},[i("InputNumber",{staticStyle:{width:"50px"},attrs:{max:99,min:0,precision:0},model:{value:t.formFirm.checkFirmwareConfig[a].a,callback:function(e){t.$set(t.formFirm.checkFirmwareConfig[a],"a",e)},expression:"formFirm.checkFirmwareConfig[index].a"}}),t._v(" "),i("span",[t._v(".")]),t._v(" "),i("InputNumber",{staticStyle:{width:"50px"},attrs:{max:99,min:0,precision:0},model:{value:t.formFirm.checkFirmwareConfig[a].b,callback:function(e){t.$set(t.formFirm.checkFirmwareConfig[a],"b",e)},expression:"formFirm.checkFirmwareConfig[index].b"}}),t._v(" "),i("span",[t._v(".")]),t._v(" "),i("InputNumber",{staticStyle:{width:"50px"},attrs:{max:99,min:0,precision:0},model:{value:t.formFirm.checkFirmwareConfig[a].c,callback:function(e){t.$set(t.formFirm.checkFirmwareConfig[a],"c",e)},expression:"formFirm.checkFirmwareConfig[index].c"}}),t._v(" "),i("span",[t._v("或")])],1)}),t._v(" "),i("Button",{staticClass:"marginTop",attrs:{type:"primary"},on:{click:function(e){t.handleEditFirmStandard(!0)}}},[i("Icon",{attrs:{type:"md-add"}})],1),t._v(" "),i("Button",{staticClass:"marginTop",attrs:{type:"primary",disabled:t.formFirm.checkFirmwareConfig.length<=0},on:{click:function(e){t.handleEditFirmStandard(!1)}}},[i("Icon",{attrs:{type:"md-remove"}})],1)],2)],1),t._v(" "),t.firmDialogLoading?i("Spin",{attrs:{fix:""}}):t._e()],1)],1)};o._withStripped=!0;var c={render:o,staticRenderFns:[]},s=c;var m=!1;var d=i("C7Lr")(n,s,!1,function(t){m||i("ObnM")},"data-v-7be63c73",null);d.options.__file="src/views/product/productInfo.vue";e.default=d.exports},FNjZ:function(t,e,i){(t.exports=i("UTlt")(!0)).push([t.i,"\n.actBox[data-v-7be63c73] {\n\tmargin-bottom: 20px;\n}\n","",{version:3,sources:["/Users/nelson/workspace/qinyuan-chance-farm-web/static-files/src/views/product/productInfo.vue"],names:[],mappings:";AACA;CACC,oBAAoB;CACpB",file:"productInfo.vue",sourcesContent:["\n.actBox[data-v-7be63c73] {\n\tmargin-bottom: 20px;\n}\n"],sourceRoot:""}])},ObnM:function(t,e,i){var a=i("FNjZ");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("FIqI")("0440e53a",a,!1,{})}});