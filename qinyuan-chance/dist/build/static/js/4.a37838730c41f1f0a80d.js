webpackJsonp([4],{WCcV:function(t,e,i){(t.exports=i("UTlt")(!0)).push([t.i,"\n.actBox[data-v-f65ed4e8] {\n\tmargin-bottom: 20px;\n}\n.title[data-v-f65ed4e8] {\n\tfont-weight: 800;\n}\n","",{version:3,sources:["/Users/nelson/workspace/qinyuan-chance-farm-web/static-files/src/views/factory/productionLine.vue"],names:[],mappings:";AACA;CACC,oBAAoB;CACpB;AACD;CACC,iBAAiB;CACjB",file:"productionLine.vue",sourcesContent:["\n.actBox[data-v-f65ed4e8] {\n\tmargin-bottom: 20px;\n}\n.title[data-v-f65ed4e8] {\n\tfont-weight: 800;\n}\n"],sourceRoot:""}])},rNU2:function(t,e,i){var a=i("WCcV");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("FIqI")("7a5a3742",a,!1,{})},tSJC:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("4YfN"),n=i.n(a),o={name:"productionLine",data:function(){var t=this;return{permisson:{disable:!1,edit:!1,delete:!1,add:!1},factoryId:"",dialogTitle:"",act:"",dialog:!1,formLoading:!0,dialogLoading:!1,form:{},rule:{productLineName:[{required:!0,message:"请输入产线名称",trigger:"blur"}],productLineCode:[{required:!0,message:"请输入产线代码",trigger:"blur"}]},infoData:{factory:""},listData:[],columns:[{type:"index",title:"序号",align:"center"},{title:"产线名称",key:"productLineName",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.productLineName))])}},{title:"产线代码",key:"productLineCode",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.productLineCode))])}},{title:"更新时间",key:"createTime",align:"center",render:function(e,i){return e("div",[e("span",t.dealNull(i.row.createTime))])}},{title:"状态",key:"status",align:"center",render:function(t,e){return t("div",[t("span","0"==e.row.status?"禁用":"1"==e.row.status?"启用":"--")])}},{title:"操作",key:"action",width:250,align:"center",render:function(e,i){return e("div",[e("Button",{props:{type:1==i.row.status?"error":"success",size:"small"},style:{display:t.permisson.disable?"inline-block":"none",marginRight:"5px"},on:{click:function(){t.handleDisable(i.row)}}},1==i.row.status?"禁用":"启用"),e("Button",{props:{type:"primary",size:"small",disabled:1==i.row.status},style:{display:t.permisson.edit?"inlin-block":"none",marginRight:"5px"},on:{click:function(){t.handleEdit(i.row)}}},"编辑"),e("Button",{props:{type:"error",size:"small",disabled:1==i.row.status},style:{display:t.permisson.delete?"inlin-block":"none"},on:{click:function(){t.handleDelete(i.row)}}},"删除")])}}]}},mounted:function(){this.$route.query.id?(this.factoryId=this.$route.query.id,this.getTableData(),this.getInfoData(),this.handleDealPermission()):this.$router.push({path:"/factory/factoryList"})},methods:{getTableData:function(){this.tableLoading=!0;var t=this.$api.manage_productLine_getProductLineList,e=n()({factoryId:this.factoryId},this.filter);this.$refs.HDTable.getListData(t,e)},getInfoData:function(){var t=this,e=this.$api.manage_factory_getFactoryInfo,i={id:this.factoryId};this.$Ax.get(e,{params:i}).then(function(e){t.infoData=e.data.data,t.modelLoading=!1}).catch(function(t){console.log(t)})},handleDisable:function(t){var e=this,i=this.$api.manage_productLine_forbidden,a=1==t.status?{id:t.id,status:0}:{id:t.id,status:1},n=1==t.status?"禁用":"启用";this.$Modal.confirm({title:"提示",content:"<p>确认"+n+"该产品（产线："+t.productLineName+"）？</p>",onOk:function(){e.$Ax.post(i,a).then(function(t){e.$Message.success(n+"成功。"),e.getTableData()}).catch(function(t){console.log(t)})},onCancel:function(){e.$Message.success("已取消禁用。")}})},handleDelete:function(t){var e=this,i=this.$api.manage_productLine_deleteProductLine,a={id:t.id};this.$Modal.confirm({title:"提示",content:"<p>确认删除该产品（产线："+t.productLineName+"）？</p>",onOk:function(){e.$Ax.post(i,a).then(function(t){e.$Message.success("删除成功。"),e.getTableData()}).catch(function(t){console.log(t)})},onCancel:function(){e.$Message.success("已取消删除。")}})},handleAdd:function(){this.cancel(),this.act="add",this.dialogTitle="添加产线",this.dialog=!0},handleEdit:function(t){var e=this;this.act="edit",this.dialogTitle="编辑",this.modelLoading=!0,this.dialog=!0;var i=this.$api.manage_productLine_getProductLineInfo,a={id:t.id};this.$Ax.get(i,{params:a}).then(function(t){e.form=t.data.data}).catch(function(t){console.log(t)})},handleWorker:function(t){},submit:function(){var t=this,e=this.$api.manage_productLine_saveProductLine,i="",a="";"add"==this.act?(a="添加成功。",i={productLineName:this.form.productLineName,productLineCode:this.form.productLineCode,status:1,factoryId:this.factoryId}):(a="编辑成功。",i={id:this.form.id,productLineName:this.form.productLineName,productLineCode:this.form.productLineCode,status:this.form.status,factoryId:this.factoryId}),this.$refs.form.validate(function(n){if(!n)return t.changeLoading();t.$Ax.post(e,i).then(function(e){e.data.success&&(t.$Message.success(a),t.getTableData(),t.dialog=!1)}).catch(function(t){console.log(t)}),setTimeout(function(){t.changeLoading()},1e3)})},cancel:function(){this.$refs.form.resetFields()},changeLoading:function(){var t=this;this.formLoading=!1,this.$nextTick(function(){t.formLoading=!0})},dealNull:function(t){return null===t||void 0===t?"--":t},handleDealPermission:function(){var t=JSON.parse(sessionStorage.getItem("menu"));for(var e in t)if("工厂管理"==t[e].name){var i=t[e].children[0].children;for(var a in i)"产线禁用启用"==i[a].name&&(this.permisson.disable=i[a].checked),"产线编辑"==i[a].name&&(this.permisson.edit=i[a].checked),"产线删除"==i[a].name&&(this.permisson.delete=i[a].checked),"产线新增"==i[a].name&&(this.permisson.add=i[a].checked)}}}},s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"productionLine"}},[i("span",{staticClass:"title"},[t._v(t._s(t.infoData.factoryName))]),t._v(" "),i("Divider"),t._v(" "),i("div",{staticClass:"filterbox"},[i("Form",{staticClass:"clearfloat",attrs:{model:t.infoData,"label-width":80,inline:""}},[i("FormItem",{staticClass:"input left marginRight",attrs:{label:"工厂代码："}},[i("span",[t._v(t._s(t.dealNull(t.infoData.factoryCode)))])]),t._v(" "),i("FormItem",{staticClass:"input left marginRight",attrs:{label:"工厂类型："}},[i("span",[t._v(t._s(t.dealNull(t.infoData.factoryType)))])]),t._v(" "),i("FormItem",{staticClass:"input left marginRight",attrs:{label:"工厂地址："}},[i("span",[t._v(t._s(t.dealNull(t.infoData.factoryAddress)))])]),t._v(" "),i("FormItem",{staticClass:"input left marginRight",attrs:{label:"添加时间："}},[i("span",[t._v(t._s(t.dealNull(t.infoData.createTime)))])])],1)],1),t._v(" "),i("div",{staticClass:"clearfloat"},[i("span",{staticClass:"title"},[t._v("产线列表")]),t._v(" "),t.permisson.add?i("Button",{staticClass:"right",attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]):t._e()],1),t._v(" "),i("Divider"),t._v(" "),i("div",{staticClass:"table clearfloat marginTop"},[i("HDTable",{ref:"HDTable",attrs:{columns:t.columns}})],1),t._v(" "),i("Modal",{staticStyle:{position:"relative"},attrs:{title:t.dialogTitle,loading:t.formLoading},on:{"on-ok":t.submit,"on-cancel":t.cancel},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("Form",{ref:"form",attrs:{model:t.form,rules:t.rule,"label-position":"right","label-width":80}},[i("FormItem",{attrs:{prop:"productLineName",label:"产线名称:"}},[i("Input",{staticClass:"input",model:{value:t.form.productLineName,callback:function(e){t.$set(t.form,"productLineName",e)},expression:"form.productLineName"}})],1),t._v(" "),i("FormItem",{attrs:{prop:"productLineCode",label:"产线代码:"}},[i("Input",{staticClass:"input",model:{value:t.form.productLineCode,callback:function(e){t.$set(t.form,"productLineCode",e)},expression:"form.productLineCode"}})],1)],1),t._v(" "),t.dialogLoading?i("Spin",{attrs:{fix:""}}):t._e()],1)],1)};s._withStripped=!0;var r={render:s,staticRenderFns:[]},c=r;var l=!1;var d=i("C7Lr")(o,c,!1,function(t){l||i("rNU2")},"data-v-f65ed4e8",null);d.options.__file="src/views/factory/productionLine.vue";e.default=d.exports}});