webpackJsonp([14],{"0BOU":function(n,t,e){var a=e("YmK7");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("FIqI")("adbefdba",a,!1,{})},TStC:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"keyEnterList",data:function(){var n=this;return{pageNum:1,total:0,pageSize:10,dialogTitle:"",act:"",dialog:!1,formLoading:!0,tableLoading:!1,dialogLoading:!1,pageLoading:!1,productLoading:!1,formProLineDisable:!0,rule:{productKey:[{required:!0,message:"请选择产品",trigger:"blur"}],planTotal:[]},form:{productKey:"",workOrderCode:"",planTotal:0,factoryId:"",productLineId:""},filter:{productKey:"",erpCode:"",workOrderCode:"",status:""},productList:[],ableProductList:[],factoryList:[],productLineList:[],columns:[{type:"selection",width:60,align:"center"},{title:"工单号",align:"center",key:"workOrderCode",width:150,render:function(t,e){return t("div",[t("Button",{props:{type:"text",size:"small"},style:{color:"blue"},on:{click:function(){n.getInfo(e.row)}}},n.dealData(e.row.workOrderCode))])}},{title:"产品名称",align:"center",key:"productName",width:200,render:function(t,e){return t("div",[t("span",n.dealData(e.row.productName))])}},{title:"ERP编号",align:"center",key:"erpcode",width:150,render:function(t,e){return t("div",[t("span",n.dealData(e.row.erpcode))])}},{title:"计划生产数量",align:"center",key:"planTotal",width:150,render:function(t,e){return t("div",[t("span",n.dealData(e.row.planTotal))])}},{title:"已生产数量",align:"center",key:"finishedTotal",width:150,render:function(t,e){return t("div",[t("span",n.dealData(e.row.finishedTotal))])}},{title:"创建时间",align:"center",width:200,key:"updateTime",render:function(t,e){return t("div",[t("span",n.dealData(e.row.updateTime))])}},{title:"任务状态",key:"status",align:"center",width:100,render:function(n,t){return n("div",[n("span",{style:{color:0==t.row.status?"green":1==t.row.status?"green":"red"}},0==t.row.status?"新建":1==t.row.status?"进行中":"结束")])}},{title:"操作",key:"erpCode",align:"center",render:function(t,e){return t("div",[t("Button",{props:{type:"success",size:"small",disabled:"2"==e.row.status},on:{click:function(){n.handleStart(e.row)}}},"开始烧录")])}}]}},mounted:function(){this.pageNum=1,this.pageSize=10,this.getTableData(),this.getProductList(),this.remoteProductList("")},methods:{getTableData:function(){this.tableLoading=!0;var n=this.$api.manage_productionTask_getProductionTaskList,t={productKey:this.filter.productKey,productName:this.filter.productName,erpCode:this.filter.erpCode,status:this.filter.status};this.$refs.HDTable.getListData(n,t)},getProductList:function(){var n=this,t=this.$api.manage_product_list;this.$Ax.get(t,{params:{pageNum:1,pageSize:100,qcForbidden:1}}).then(function(t){n.productList=t.data.data}).catch(function(n){console.log(n)})},handleAdd:function(){this.dialogTitle="新建任务",this.act="add",this.dialog=!0},handleStart:function(n){var t=this;this.$Modal.confirm({title:"提示",content:"<p>确认开始烧录任务？</p>",onOk:function(){var e=t.$api.manage_productionTask_forbidden,a={id:n.id,status:1};t.$Ax.post(e,a).then(function(e){e.data.success&&t.$router.push({push:"/keyEnterPage/keyEnter",name:"keyEnter",query:{id:n.id,taskProductKey:n.productKey}})}).catch(function(n){console.log(n)})},onCancel:function(){t.$Message.success("已取消开启。")}})},remoteProductList:function(n){var t=this;this.productLoading=!0;var e=this.$api.manage_product_productList,a={productName:n};this.$Ax.get(e,{params:a}).then(function(n){var e=n.data.data;for(var a in t.ableProductList=[],e){var r={name:e[a].split("-HadLinks-")[0],productKey:e[a].split("-HadLinks-")[1]};t.ableProductList.push(r)}t.productLoading=!1}).catch(function(n){console.log(n)})},submit:function(){var n=this;if("info"==this.act)this.dialog=!1;else{var t=this.$api.manage_productionTask_saveProductionTask,e={productKey:this.form.productKey,workOrderCode:this.form.workOrderCode,planTotal:this.form.planTotal};this.$refs.form.validate(function(a){if(!a)return n.changeLoading();n.$Ax.post(t,e).then(function(t){t.data.success&&(n.$Message.success("添加任务成功。"),n.getTableData(),n.dialog=!1)}).catch(function(n){console.log(n)}),setTimeout(function(){n.changeLoading()},1e3)})}},cancel:function(){this.$refs.form.resetFields()},changeLoading:function(){var n=this;this.formLoading=!1,this.$nextTick(function(){n.formLoading=!0})},dealData:function(n){return""===n||null===n?"--":n}}},r=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"clearfloat",staticStyle:{position:"relative"},attrs:{id:"keyEnterList"}},[e("div",{staticClass:"actBox clearfloat"},[e("Button",{staticClass:"left",attrs:{type:"primary"},on:{click:n.getTableData}},[n._v("查询")]),n._v(" "),e("Button",{staticClass:"right",attrs:{type:"primary"},on:{click:n.handleAdd}},[n._v("直接烧写")])],1),n._v(" "),e("div",{staticClass:"filterbox marginTop"},[e("Form",{ref:"filter",staticClass:"clearfloat",attrs:{model:n.filter,"label-width":0}},[e("FormItem",{staticClass:"input left marginRight",attrs:{prop:"productKey"}},[e("Select",{staticClass:"input marginRight",attrs:{placeholder:"产品名称",clearable:""},model:{value:n.filter.productKey,callback:function(t){n.$set(n.filter,"productKey",t)},expression:"filter.productKey"}},n._l(n.productList,function(t){return e("Option",{key:t.productKey,attrs:{value:t.productKey}},[n._v(n._s(t.name))])}))],1),n._v(" "),e("FormItem",{staticClass:"input left marginRight",attrs:{prop:"erpCode"}},[e("Input",{staticClass:"input",attrs:{placeholder:"ERP编号"},model:{value:n.filter.erpCode,callback:function(t){n.$set(n.filter,"erpCode",t)},expression:"filter.erpCode"}})],1),n._v(" "),e("FormItem",{staticClass:"input left marginRight",attrs:{prop:"workOrderCode"}},[e("Input",{staticClass:"input",attrs:{placeholder:"工单号"},model:{value:n.filter.workOrderCode,callback:function(t){n.$set(n.filter,"workOrderCode",t)},expression:"filter.workOrderCode"}})],1),n._v(" "),e("FormItem",{staticClass:"input left marginRight",attrs:{prop:"status"}},[e("Select",{staticClass:"input marginRight",attrs:{placeholder:"任务状态",clearable:""},model:{value:n.filter.status,callback:function(t){n.$set(n.filter,"status",t)},expression:"filter.status"}},[e("Option",{attrs:{value:0}},[n._v("新建")]),n._v(" "),e("Option",{attrs:{value:1}},[n._v("进行中")]),n._v(" "),e("Option",{attrs:{value:2}},[n._v("结束")])],1)],1)],1)],1),n._v(" "),e("div",{staticStyle:{position:"relative"}},[e("HDTable",{ref:"HDTable",attrs:{columns:n.columns}})],1),n._v(" "),e("Modal",{staticStyle:{position:"relative"},attrs:{title:n.dialogTitle,loading:n.formLoading,width:"45"},on:{"on-ok":n.submit,"on-cancel":n.cancel},model:{value:n.dialog,callback:function(t){n.dialog=t},expression:"dialog"}},[e("Form",{ref:"form",attrs:{model:n.form,rules:n.rule,"label-position":"right","label-width":150}},[e("FormItem",{attrs:{prop:"productKey",label:"产品名称:"}},[e("Select",{staticClass:"input marginRight",attrs:{loading:n.productLoading,placeholder:"产品名称",filterable:"",remote:"","remote-method":n.remoteProductList,clearable:""},model:{value:n.form.productKey,callback:function(t){n.$set(n.form,"productKey",t)},expression:"form.productKey"}},n._l(n.ableProductList,function(t){return e("Option",{key:t.productKey,attrs:{value:t.productKey}},[n._v(n._s(t.name))])}))],1),n._v(" "),e("FormItem",{attrs:{prop:"workOrderCode",label:"工单号:"}},[e("Input",{staticClass:"input",attrs:{placeholder:"工单号"},model:{value:n.form.workOrderCode,callback:function(t){n.$set(n.form,"workOrderCode",t)},expression:"form.workOrderCode"}})],1),n._v(" "),e("FormItem",{attrs:{prop:"planTotal",label:"计划总量:"}},[e("InputNumber",{staticClass:"input",attrs:{precision:0,placeholder:"计划总量"},model:{value:n.form.planTotal,callback:function(t){n.$set(n.form,"planTotal",t)},expression:"form.planTotal"}})],1)],1)],1),n._v(" "),n.pageLoading?e("Spin",{attrs:{fixd:""}}):n._e()],1)};r._withStripped=!0;var o={render:r,staticRenderFns:[]},i=o;var s=!1;var l=e("C7Lr")(a,i,!1,function(n){s||e("0BOU")},"data-v-73aec263",null);l.options.__file="src/views/keyEnter/keyEnterList.vue";t.default=l.exports},YmK7:function(n,t,e){(n.exports=e("UTlt")(!0)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","",{version:3,sources:[],names:[],mappings:"",file:"keyEnterList.vue",sourceRoot:""}])}});