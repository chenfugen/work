webpackJsonp([8],{JEgm:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("4YfN"),s=a.n(o),r={name:"factoryList",data:function(){var t=this;return{permisson:{disable:!1,info:!1,edit:!1,delete:!1,add:!1},dialogTitle:"",act:"",dialog:!1,formLoading:!0,dialogLoading:!1,form:{factoryName:"",factoryCode:"",factoryAddress:"",factoryType:"",status:""},rule:{factoryName:[{required:!0,message:"请输入工厂名称",trigger:"blur"}],factoryCode:[{required:!0,message:"请输入工厂代码",trigger:"blur"}],factoryType:[{required:!0,message:"请选择工厂类型",trigger:"blur"}]},filter:{factory:""},columns:[{type:"index",title:"序号",align:"center"},{title:"工厂名称",key:"factoryName",align:"center",render:function(e,a){return e("div",[e("span",t.dealNull(a.row.factoryName))])}},{title:"工厂代码",key:"factoryCode",align:"center",render:function(e,a){return e("div",[e("span",t.dealNull(a.row.factoryCode))])}},{title:"工厂地址",key:"factoryAddress",align:"center",render:function(e,a){return e("div",[e("span",t.dealNull(a.row.factoryAddress))])}},{title:"工厂类型",key:"factoryType",align:"center",render:function(e,a){return e("div",[e("span",t.dealNull(a.row.factoryType))])}},{title:"状态",key:"status",align:"center",render:function(t,e){return t("div",[t("span",{style:{color:"1"==e.row.status?"green":"red"}},"1"==e.row.status?"启用":"禁用")])}},{title:"操作",key:"action",width:250,align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"1"==a.row.status?"error":"success",size:"small"},style:{display:t.permisson.disable?"inlin-block":"none",marginRight:"5px"},on:{click:function(){t.handleDisable(a.row)}}},"1"==a.row.status?"禁用":"启用"),e("Button",{props:{type:"primary",size:"small",disabled:"1"==a.row.status},style:{display:t.permisson.info?"inlin-block":"none",marginRight:"5px"},on:{click:function(){t.goInfo(a.row)}}},"查看"),e("Button",{props:{type:"primary",size:"small",disabled:"1"==a.row.status},style:{display:t.permisson.edit,marginRight:"5px"},on:{click:function(){t.handleEdit(a.row)}}},"编辑"),e("Button",{props:{type:"error",size:"small",disabled:"1"==a.row.status},style:{display:t.permisson.delete},on:{click:function(){t.handleDelete(a.row)}}},"删除")])}}]}},mounted:function(){this.getTableData(),this.handleDealPermisson()},methods:{getTableData:function(){var t=this.$api.manage_factory_getFactoryList,e=s()({},this.filter);this.$refs.HDTable.getListData(t,e)},handleDisable:function(t){var e=this,a=this.$api.manage_factory_forbidden,o={},s="";1==t.status?(o={id:t.id,status:0},s="禁用"):(o={id:t.id,status:1},s="启用"),this.$Modal.confirm({title:"提示",content:"<p>确认"+s+"该工厂（工厂："+t.factoryName+"）？</p>",onOk:function(){e.$Ax.post(a,o).then(function(t){e.$Message.success(s+"成功。"),e.getTableData()}).catch(function(t){console.log(t)})},onCancel:function(){e.$Message.success("已取消禁用。")}})},handleDelete:function(t){var e=this,a=this.$api.manage_factory_deleteFactory,o={id:t.id};this.$Modal.confirm({title:"提示",content:"<p>确认删除该条工厂（工厂："+t.factoryName+"）？</p>",onOk:function(){e.$Ax.post(a,o).then(function(t){t.data.success&&(e.$Message.success("删除成功。"),e.getTableData())}).catch(function(t){console.log(t)})},onCancel:function(){e.$Message.success("已取消删除。")}})},handleAdd:function(t){this.cancel(),this.act="add",this.dialogTitle="添加工厂",this.modelLoading=!0,this.dialog=!0},handleEdit:function(t){var e=this;this.act="edit",this.dialogTitle="编辑",this.modelLoading=!0,this.dialog=!0;var a=this.$api.manage_factory_getFactoryInfo,o={id:t.id};this.$Ax.get(a,{params:o}).then(function(t){e.form=t.data.data,e.modelLoading=!1}).catch(function(t){console.log(t)})},goInfo:function(t){this.$router.push({path:"/factory/productionLine",query:{id:t.id}})},submit:function(){var t=this,e=this.$api.manage_factory_saveFactory,a="",o="";"add"==this.act?(o="添加成功。",a={factoryName:this.form.factoryName,factoryCode:this.form.factoryCode,factoryAddress:this.form.factoryAddress,factoryType:this.form.factoryType,status:"1"}):(o="编辑成功。",a={id:this.form.id,factoryName:this.form.factoryName,factoryCode:this.form.factoryCode,factoryAddress:this.form.factoryAddress,factoryType:this.form.factoryType,status:this.form.status}),this.$refs.form.validate(function(s){if(!s)return t.changeLoading();t.$Ax.post(e,a).then(function(e){e.data.success&&(t.$Message.success(o),t.getTableData(),t.dialog=!1)}).catch(function(t){console.log(t)}),setTimeout(function(){t.changeLoading()},1e3)})},cancel:function(){this.$refs.form.resetFields()},changeLoading:function(){var t=this;this.formLoading=!1,this.$nextTick(function(){t.formLoading=!0})},dealNull:function(t){return null===t||void 0===t?"--":t},handleDealPermisson:function(){var t=JSON.parse(sessionStorage.getItem("menu"));for(var e in t)if("工厂管理"==t[e].name){var a=t[e].children[0].children;for(var o in a)"工厂禁用启用"==a[o].name&&(this.permisson.disable=a[o].checked,console.log(this.permisson.disable)),"产线管理"==a[o].name&&(this.permisson.info=a[o].checked),"工厂编辑"==a[o].name&&(this.permisson.edit=a[o].checked),"工厂删除"==a[o].name&&(this.permisson.delete=a[o].checked),"工厂新增"==a[o].name&&(this.permisson.add=a[o].checked)}}}},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"factoryList"}},[a("div",{staticClass:"actBox clearfloat"},[a("Button",{staticClass:"left",attrs:{type:"primary"},on:{click:t.getTableData}},[t._v("查询")]),t._v(" "),t.permisson.add?a("Button",{staticClass:"right",attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]):t._e()],1),t._v(" "),a("div",{staticClass:"filterbox"},[a("Form",{ref:"filter",staticClass:"clearfloat",attrs:{model:t.filter,"label-width":0}},[a("FormItem",{staticClass:"input left marginRight",attrs:{prop:"factoryName"}},[a("Input",{staticClass:"input",attrs:{placeholder:"工厂名称",clearable:""},model:{value:t.filter.factoryName,callback:function(e){t.$set(t.filter,"factoryName",e)},expression:"filter.factoryName"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"table clearfloat marginTop"},[a("HDTable",{ref:"HDTable",attrs:{columns:t.columns}})],1),t._v(" "),a("Modal",{staticStyle:{position:"relative"},attrs:{title:t.dialogTitle,loading:t.formLoading},on:{"on-ok":t.submit,"on-cancel":t.cancel},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("Form",{ref:"form",attrs:{model:t.form,rules:t.rule,"label-position":"right","label-width":80}},[a("FormItem",{attrs:{prop:"factoryName",label:"工厂名称:"}},[a("Input",{staticClass:"input",model:{value:t.form.factoryName,callback:function(e){t.$set(t.form,"factoryName",e)},expression:"form.factoryName"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"factoryCode",label:"工厂代码:"}},[a("Input",{staticClass:"input",model:{value:t.form.factoryCode,callback:function(e){t.$set(t.form,"factoryCode",e)},expression:"form.factoryCode"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"factoryAddress",label:"工厂地址:"}},[a("Input",{staticClass:"input",model:{value:t.form.factoryAddress,callback:function(e){t.$set(t.form,"factoryAddress",e)},expression:"form.factoryAddress"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"factoryType",label:"工厂类型:"}},[a("Select",{staticClass:"input",attrs:{placeholder:"工厂类型",clearable:""},model:{value:t.form.factoryType,callback:function(e){t.$set(t.form,"factoryType",e)},expression:"form.factoryType"}},[a("Option",{attrs:{value:"沁园"}},[t._v("沁园")]),t._v(" "),a("Option",{attrs:{value:"代工厂"}},[t._v("代工厂")])],1)],1)],1),t._v(" "),t.dialogLoading?a("Spin",{attrs:{fix:""}}):t._e()],1)],1)};i._withStripped=!0;var n={render:i,staticRenderFns:[]},c=n;var l=!1;var d=a("C7Lr")(r,c,!1,function(t){l||a("Ok1Y")},"data-v-cf1e10ce",null);d.options.__file="src/views/factory/factoryList.vue";e.default=d.exports},Ok1Y:function(t,e,a){var o=a("mBdH");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("FIqI")("c52848f8",o,!1,{})},mBdH:function(t,e,a){(t.exports=a("UTlt")(!0)).push([t.i,"\n.actBox[data-v-cf1e10ce] {\n\tmargin-bottom: 20px;\n}\n","",{version:3,sources:["/Users/nelson/workspace/qinyuan-chance-farm-web/static-files/src/views/factory/factoryList.vue"],names:[],mappings:";AACA;CACC,oBAAoB;CACpB",file:"factoryList.vue",sourcesContent:["\n.actBox[data-v-cf1e10ce] {\n\tmargin-bottom: 20px;\n}\n"],sourceRoot:""}])}});