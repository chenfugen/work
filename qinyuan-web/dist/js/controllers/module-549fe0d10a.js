"use strict";app.controller("usedListC",["$scope","$http","$location",function(o,e,t){o.dialog=function(e,t){o.fun=e,o.id=t,"change"==e?(o.dialogStyle={zIndex:19891015,width:"400px",height:"350px",top:"30%",left:"50%",marginLeft:"-200px"},o.moduleCode="",o.identityId=""):(o.dialogStyle={zIndex:19891015,width:"700px",height:"500px",top:"20%",left:"50%",marginLeft:"-300px"},dataRequest("get","manage/moduleRecord/getModuleRecordInfo",{id:o.id},function(e){o.historyList=e.data,o.$apply()})),$(".layui-layer-shade").show(),$(".layui-layer").show()},o.close=function(){$(".layui-layer-shade").hide(),$(".layui-layer").hide()},o.save=function(){if("change"==o.fun){if(""==o.moduleCode||null==o.moduleCode)return alert("请输入模块编码！"),!1;if(""==o.identityId||null==o.identityId)return alert("请输入MAC编码！"),!1;dataRequest("post","manage/module/changeModule",{moduleCode:o.moduleCode,identityId:o.identityId,id:o.id},function(e){e.success?(alert("更换成功!"),o.init(1,10,o.form,!0)):alert(e.message)})}},o.form={productModel:"",manufacturer:"",moduleCode:"",identityId:"",snCode:"",deviceName:"",netType:"NET_WIFI",status:"3"},o.selectNet=function(e){o.form.netType=e,o.init(1,10,o.form,!0)},o.init=function(e,t,a,i){dataRequest("get","manage/module/getModuleList",_extends({pageNum:e,pageSize:t},a),function(e){o.usedList=e.data,i&&pageUtils(e.total,"usedlist",function(e){o.init(e.curr,e.limit,o.form,!1)}),o.$apply()})},o.init(1,10,o.form,!0)}]),app.controller("stockListC",["$scope","$http","$location",function(o,e,t){o.netTypeList=JSON.parse(sessionStorage.getItem("netType")),o.dialog=function(e,t){o.fun=e,o.id=t,"scrap"!=e&&"delete"!=e&&"edit"!=e||(o.dialogStyle={zIndex:19891015,width:"450px",height:"180px",top:"30%",left:"50%",marginLeft:"-210px"},$(".layui-layer-shade").show(),$(".layui-layer").show())},o.close=function(){$(".layui-layer-shade").hide(),$(".layui-layer").hide()},o.getImportList=function(){dataRequest("get","manage/module/getModuleImportPreList",{pageNum:1,pageSize:10},function(e){o.listData=e.data,o.$apply(),$(".layui-layer-shade").show(),$(".layui-layer").show()})},o.updataFile=function(e){imgUpload("POST","manage/module/import",e,function(e){e.success?(o.fun="add",o.dialogStyle={zIndex:19891015,width:"700px",maxHeight:"500px",height:"auto",top:"20%",left:"50%",marginLeft:"-300px"},o.getImportList()):alert(e.message)})},layui.use("upload",function(){layui.jquery;layui.upload.render({elem:"#testList",accept:"file",multiple:!0,auto:!1,choose:function(e){e.preview(function(e,t,a){if(1048576<t.size)return alert("上传文件超出1M大小!"),!1;var i=new FormData;i.append("file",t),o.updataFile(i)})}})}),o.delete=function(e){dataRequest("post","manage/module/deleteModule",{id:e},function(e){e.success?o.getImportList():alert(e.message)})},o.save=function(){"add"==o.fun&&dataRequest("post","manage/module/addModuleBatch",{},function(e){e.success?(alert(e.message),o.init(1,10,o.form,!0)):alert(e.message),o.close()}),"scrap"==o.fun&&dataRequest("post","manage/module/updateModuleStatus",{id:o.id,status:4},function(e){e.success?(alert("报废成功!"),o.init(1,10,o.form,!0)):alert(e.message),o.close()}),"delete"==o.fun&&dataRequest("post","manage/module/deleteModule",{id:o.id},function(e){e.success?(alert("删除成功!"),o.init(1,10,o.form,!0)):alert(e.message),o.close()}),"edit"==o.fun&&dataRequest("post","manage/module/updateModuleStatus",{id:o.id,status:2},function(e){e.success?(alert("添加成功!"),o.init(1,10,o.form,!0)):alert(e.message),o.close()})},o.form={productModel:"",manufacturer:"",moduleCode:"",identityId:"",snCode:"",deviceName:"",netType:"",status:2},o.selectNet=function(e){o.form.status=e,o.init(1,10,o.form,!0)},o.init=function(e,t,a,i){dataRequest("get","manage/module/getModuleList",_extends({pageNum:e,pageSize:t},a),function(e){o.stockList=e.data,i&&pageUtils(e.total,"stockList",function(e){o.init(e.curr,e.limit,o.form,!1)}),o.$apply()})},o.init(1,10,o.form,!0)}]);